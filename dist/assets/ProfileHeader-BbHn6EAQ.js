import{c as v,r as h,u as _,a as j,b as x,j as e,U as z,C as P,d as A,X as F,e as l,f as c}from"./index-gyCvFeup.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],y=v("camera",Q);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],M=v("map-pin",U),H=({userData:s,onSave:N,isOwnProfile:p})=>{const[o,b]=h.useState(!1),[a,d]=h.useState({}),u=_(),{data:C}=j({queryKey:["authUser"]}),{data:i,refetch:m}=j({queryKey:["connectionStatus",s._id],queryFn:()=>l.get(`/connections/status/${s._id}`),enabled:!p}),g=s.connections.some(t=>t===C._id),{mutate:w}=x({mutationFn:t=>l.post(`/connections/request/${t}`),onSuccess:()=>{c.success("Connection request sent"),m(),u.invalidateQueries(["connectionRequests"])},onError:t=>{var r,n;c.error(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"An error occurred")}}),{mutate:q}=x({mutationFn:t=>l.put(`/connections/accept/${t}`),onSuccess:()=>{c.success("Connection request accepted"),m(),u.invalidateQueries(["connectionRequests"])},onError:t=>{var r,n;c.error(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"An error occurred")}}),{mutate:k}=x({mutationFn:t=>l.put(`/connections/reject/${t}`),onSuccess:()=>{c.success("Connection request rejected"),m(),u.invalidateQueries(["connectionRequests"])},onError:t=>{var r,n;c.error(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"An error occurred")}}),{mutate:R}=x({mutationFn:t=>l.delete(`/connections/${t}`),onSuccess:()=>{c.success("Connection removed"),m(),u.invalidateQueries(["connectionRequests"])},onError:t=>{var r,n;c.error(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"An error occurred")}}),$=h.useMemo(()=>{var t;return g?"connected":g?(t=i==null?void 0:i.data)==null?void 0:t.status:"not_connected"},[g,i]),E=()=>{const t="text-white py-2 px-4 rounded-full transition duration-300 flex items-center justify-center";switch($){case"connected":return e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs("div",{className:`${t} bg-green-500 hover:bg-green-600`,children:[e.jsx(A,{size:20,className:"mr-2"}),"Connected"]}),e.jsxs("button",{className:`${t} bg-red-500 hover:bg-red-600 text-sm`,onClick:()=>R(s._id),children:[e.jsx(F,{size:20,className:"mr-2"}),"Remove Connection"]})]});case"pending":return e.jsxs("button",{className:`${t} bg-yellow-500 hover:bg-yellow-600`,children:[e.jsx(P,{size:20,className:"mr-2"}),"Pending"]});case"received":return e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx("button",{onClick:()=>q(i.data.requestId),className:`${t} bg-green-500 hover:bg-green-600`,children:"Accept"}),e.jsx("button",{onClick:()=>k(i.data.requestId),className:`${t} bg-red-500 hover:bg-red-600`,children:"Reject"})]});default:return e.jsxs("button",{onClick:()=>w(s._id),className:"bg-primary hover:bg-primary-dark text-white py-2 px-4 rounded-full transition duration-300 flex items-center justify-center",children:[e.jsx(z,{size:20,className:"mr-2"}),"Connect"]})}},f=t=>{const r=t.target.files[0];if(r){const n=new FileReader;n.onloadend=()=>{d(S=>({...S,[t.target.name]:n.result}))},n.readAsDataURL(r)}},I=()=>{N(a),b(!1)};return e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl overflow-hidden mb-8",children:[e.jsx("div",{className:"relative h-52 bg-cover bg-center",style:{backgroundImage:`url('${a.bannerImg||s.bannerImg||"/banner.png"}')`},children:o&&e.jsxs("label",{className:"absolute top-3 right-3 bg-white p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-100",children:[e.jsx(y,{size:20,className:"text-gray-700"}),e.jsx("input",{type:"file",className:"hidden",name:"bannerImg",onChange:f,accept:"image/*"})]})}),e.jsxs("div",{className:"p-6 relative -mt-16",children:[e.jsxs("div",{className:"relative w-32 h-32 mx-auto mb-4",children:[e.jsx("img",{src:a.profilePicture||s.profilePicture||"/avatar.png",alt:s.name,className:"w-full h-full rounded-full object-cover border-4 border-white shadow-lg"}),o&&e.jsxs("label",{className:"absolute bottom-0 right-0 bg-white p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-100",children:[e.jsx(y,{size:20,className:"text-gray-700"}),e.jsx("input",{type:"file",className:"hidden",name:"profilePicture",onChange:f,accept:"image/*"})]})]}),e.jsxs("div",{className:"text-center",children:[o?e.jsx("input",{type:"text",value:a.name??s.name,onChange:t=>d({...a,name:t.target.value}),className:"text-2xl font-semibold text-center mb-1 w-full border-none focus:ring-0"}):e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:s.name}),o?e.jsx("input",{type:"text",value:a.headline??s.headline,onChange:t=>d({...a,headline:t.target.value}),className:"text-sm text-gray-600 text-center w-full border-none focus:ring-0"}):e.jsx("p",{className:"text-sm text-gray-600",children:s.headline}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-gray-500 mt-2 text-sm",children:[e.jsx(M,{size:16}),o?e.jsx("input",{type:"text",value:a.location??s.location,onChange:t=>d({...a,location:t.target.value}),className:"text-center text-sm border-none focus:ring-0"}):e.jsx("span",{children:s.location})]})]}),e.jsx("div",{className:"mt-6",children:p?o?e.jsx("button",{className:"w-full bg-primary text-white py-2 px-4 rounded-full font-medium hover:bg-primary-dark transition-all duration-300",onClick:I,children:"Save Profile"}):e.jsx("button",{className:"w-full bg-primary text-white py-2 px-4 rounded-full font-medium hover:bg-primary-dark transition-all duration-300",onClick:()=>b(!0),children:"Edit Profile"}):e.jsx("div",{className:"flex justify-center",children:E()})})]})]})};export{H as default};
